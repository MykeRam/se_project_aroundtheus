(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",()=>{this._handleLikeIcon()}),this._deleteButton.addEventListener("click",()=>{this._handleDeleteCard()}),this._cardImage.addEventListener("click",()=>{this._handleImageClick(this._link,this._name)})}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}_handleDeleteCard(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some(e=>!e.validity.valid)}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach(e=>{e.addEventListener("input",()=>{this._checkInputValidity(e),this._toggleButtonState()})})}enableValidation(){this._formElement.addEventListener("submit",e=>{e.preventDefault()}),this._setEventListeners()}disableSubmitButton(){this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)}resetValidation(){this._inputList.forEach(e=>{this._hideInputError(e)}),this.disableSubmitButton()}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",e=>{e.target===e.currentTarget&&this.close(),e.target.classList.contains("modal__close")&&this.close()})}}class n extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".modal__form"),this._inputList=Array.from(this._form.querySelectorAll(".modal__input"))}_getInputValues(){const e={};return this._inputList.forEach(t=>{e[t.name]=t.value}),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})}close(){super.close(),this._form.reset()}}const i={};var r;r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(r.formSelector)).forEach(e=>{const s=new t(r,e),n=e.getAttribute("name");i[n]=s,s.enableValidation()});const o=new class{constructor({nameSelector:e,jobSelector:t}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo({name:e,job:t}){this._nameElement.textContent=e,this._jobElement.textContent=t}}({nameSelector:".profile__title",jobSelector:".profile__description"}),a=new class extends s{constructor(e){super(e),this._image=this._popup.querySelector(".card__image_preview"),this._caption=this._popup.querySelector(".modal__caption")}open({name:e,link:t}){this._image.src=t,this._image.alt=e,this._caption.textContent=e,super.open()}}("#modal_type-preview");function l(e,t){a.open({name:t,link:e})}function c(t){return new e(t,"#card-template",l).generateCard()}a.setEventListeners();const u=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach(e=>this._renderer(e))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=c(e);u.addItem(t)}},".cards__list");u.renderItems();const _=new n("#profile-edit-modal",e=>{o.setUserInfo({name:e.title,job:e.description}),i["profile-form"].disableSubmitButton()});_.setEventListeners();const m=new n("#add-card-modal",e=>{const t=c({name:e.title,link:e.url});u.addItem(t),i["card-form"].disableSubmitButton()});m.setEventListeners();const d=document.querySelector("#profile-edit-button"),h=document.querySelector(".profile__add-button");d.addEventListener("click",()=>{const e=o.getUserInfo(),t=document.querySelector("#profile-edit-modal .modal__form");t.querySelector(".modal__input_type_name").value=e.name,t.querySelector(".modal__input_type_description").value=e.job,i["profile-form"].resetValidation(),_.open()}),h.addEventListener("click",()=>{i["card-form"].resetValidation(),m.open()})})();